# Duplicate any fields required by the process agent from the main datadog.yaml file here
# Logging
#
log_level: <%= p("dd.log_level", "INFO") %>

# Dogstatsd
dogstatsd_port: <%= p("dd.dogstatsd_port", "18125") %>

# Dedicated system probe section
<% if p('dd.system_probe_enabled', false) == true || p('dd.system_probe_enabled', false) =~ (/(true|t|yes|y|1)$/i) %>
# System probe specific settings
system_probe_config:
  enabled: true
  sysprobe_socket: /var/vcap/packages/dd-agent/run/sysprobe.sock
  log_file: /var/vcap/sys/log/dd-agent/system-probe.log
<% end %>

cloud_foundry: true
<% if spec.id and not spec.id.empty? %>
bosh_id: <%= spec.id %>
<% end %>

<%
if_link("datadog-cluster-agent") do |dca_link|
  if dca_link.instances.length > 0 && dca_link.p('cluster_agent.enabled') == true
%>
cluster_agent:
  auth_token: <%= dca_link.p("cluster_agent.token") %>
  url: https://<%= dca_link.address %>:<%= dca_link.p("cluster_agent.port") %>
  enabled: <%= dca_link.p("cluster_agent.enabled") %>
<%
  end
end
%>
